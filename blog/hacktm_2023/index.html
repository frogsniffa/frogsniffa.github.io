<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=../../katex/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ><script defer src=../../katex/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY></script>
<script defer src=../../katex/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR onload=renderMathInElement(document.body)></script><link rel=stylesheet href=../../css/highlight-emacs.css><link rel=stylesheet href=../../css/brutalist-minimalist-variables.css>
<link rel=stylesheet href=../../css/brutalist-minimalist.css><link rel=stylesheet type=text/css href=../../css/bm-responsiveness.css><link rel=stylesheet href=../../css/beyond-minimalism.css><link rel=stylesheet href=../../css/brutalist-minimalist-fonts.css><link rel=stylesheet href=../../css/bm-printing.css media=print><title>hacktm 2023 | frogsniffa</title></head><body leftmargin=40 rightmarin=40><header><input id=menu-toggle type=checkbox hidden><div id=nav-area><label id=menu-button for=menu-toggle></label><nav id=nav-menu><a href=../../>Home</a>
<a href=../../about/site/>About</a></nav></div><h1><a href=../../>frogsniffa</a></h1><em id=subtitle></em></header><main><h2>hacktm 2023</h2><h2 id=d_phi_enc>d_phi_enc</h2><h3 id=problem>Problem</h3><p>Given standard RSA, solve for the plaintext if \( e = 3 \) and additional hints \( c_e \) and \( c_\phi \) were given.
\[ \tag{1} c_e \equiv d^e \bmod{n} \]
\[ \tag{2} c_\phi \equiv \phi^e \bmod{n} \].</p><h3 id=solution>Solution</h3><p>Multiply \( e^e \) on both sides of (1) to transform it into \( e^e c_e \equiv e^e d^e \equiv (ed)^e \bmod{n} \).</p><p>Observe for (2) a re-definition of \( \phi \) into \( \phi = \frac{ed - 1}{k} \). After testing for what \( k \) could be, I found \( k = 2 \) multiple times. This made sense because \( e \) is small. Relating the re-definition to (2), we have \( \phi^e \equiv {(\frac{ed - 1}{2})}^e \bmod{n} \).</p><p>By multiplying \( 2^e \) on both sides of (2), we have an equation very similar to (1) which is \( c_\phi 2^e \equiv (ed - 1)^e \bmod{n} \).</p><p>We may now apply the Franklin-Reiter related message attack to solve for \( ed \). The attack&rsquo;s precondition is if two messages are encrypted under the same RSA conditions, their difference must be known. Fun fact: Michael Reiter used to teach at my alma mater.</p><h3 id=script>Script</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span> <span class=k>as</span> <span class=n>lb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>24476383567792760737445809443492789639532562013922247811020136923589010741644222420227206374197451638950771413340924096340837752043249937740661704552394497914758536695641625358888570907798672682231978378863166006326676708689766394246962358644899609302315269836924417613853084331305979037961661767481870702409724154783024602585993523452019004639755830872907936352210725695418551084182173371461071253191795891364697373409661909944972555863676405650352874457152520233049140800885827642997470620526948414532553390007363221770832301261733085022095468538192372251696747049088035108525038449982810535032819511871880097702167</span>
</span></span><span class=line><span class=cl><span class=n>enc_d</span> <span class=o>=</span> <span class=mi>23851971033205169724442925873736356542293022048328010529601922038597156073052741135967263406916098353904000351147783737673489182435902916159670398843992581022424040234578709904403027939686144718982884200573860698818686908312301218022582288691503272265090891919878763225922888973146019154932207221041956907361037238034826284737842344007626825211682868274941550017877866773242511532247005459314727939294024278155232050689062951137001487973659259356715242237299506824804517181218221923331473121877871094364766799442907255801213557820110837044140390668415470724167526835848871056818034641517677763554906855446709546993374</span>
</span></span><span class=line><span class=cl><span class=n>enc_phi</span> <span class=o>=</span> <span class=mi>3988439673093122433640268099760031932750589560901017694612294237734994528445711289776522094320029720250901589476622749396945875113134575148954745649956408698129211447217738399970996146231987508863215840103938468351716403487636203224224211948248426979344488189039912815110421219060901595845157989550626732212856972549465190609710288441075239289727079931558808667820980978069512061297536414547224423337930529183537834934423347408747058506318052591007082711258005394876388007279867425728777595263973387697391413008399180495885227570437439156801767814674612719688588210328293559385199717899996385433488332567823928840559</span>
</span></span><span class=line><span class=cl><span class=n>enc_flag</span> <span class=o>=</span> <span class=mi>24033688910716813631334059349597835978066437874275978149197947048266360284414281504254842680128144566593025304122689062491362078754654845221441355173479792783568043865858117683452266200159044180325485093879621270026569149364489793568633147270150444227384468763682612472279672856584861388549164193349969030657929104643396225271183660397476206979899360949458826408961911095994102002214251057409490674577323972717947269749817048145947578717519514253771112820567828846282185208033831611286468127988373756949337813132960947907670681901742312384117809682232325292812758263309998505244566881893895088185810009313758025764867</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc_ed</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=n>enc_d</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>enc_ed_1</span> <span class=o>=</span> <span class=n>enc_phi</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=n>PolynomialRing</span><span class=p>(</span><span class=n>Zmod</span><span class=p>(</span><span class=n>n</span><span class=p>),</span> <span class=s2>&#34;x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>P</span><span class=o>.</span><span class=n>gens</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=n>x</span> <span class=o>**</span> <span class=n>e</span> <span class=o>-</span> <span class=n>enc_ed</span>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>**</span> <span class=n>e</span> <span class=o>-</span> <span class=n>enc_ed_1</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>f1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=p>,</span> <span class=n>f1</span> <span class=o>=</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f</span> <span class=o>%</span> <span class=n>f1</span>
</span></span><span class=line><span class=cl><span class=n>gcd_</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>monic</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ed</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=o>-</span><span class=n>gcd_</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>ed</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>enc_flag</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>lb</span><span class=p>(</span><span class=n>flag</span><span class=p>))</span>
</span></span></code></pre></div></main><footer><span id=footer-links></span></footer><p id=source-url>Source: <a href=../../blog/hacktm_2023/>https://frogsniffa.github.io/blog/hacktm_2023/</a>, 0001-01-01</p></body>